# ðŸš€ Complete Deployment Guide for Meldra

## ðŸ“‹ Overview

You need to deploy:
1. **Frontend** (React app) â†’ Vercel âœ… (You're doing this!)
2. **Backend** (FastAPI) â†’ Railway/Render/DigitalOcean
3. **Database** (PostgreSQL) â†’ Neon/Railway/Supabase

---

## ðŸŽ¯ Step 1: Deploy Frontend to Vercel (In Progress)

### **You're Already Doing This!**

I can see you're logging into Vercel. Here's what to do:

### **After Login:**

1. **Follow Vercel prompts:**
   - Set up and deploy? â†’ **Yes**
   - Which scope? â†’ **Your account**
   - Link to existing project? â†’ **No** (first time)
   - Project name? â†’ **meldra** (or your choice)
   - Directory? â†’ **./** (current directory)
   - Override settings? â†’ **No**

2. **Vercel will:**
   - Detect it's a Vite project
   - Build automatically
   - Deploy to a URL like `https://meldra.vercel.app`

3. **Set Environment Variables:**
   ```bash
   # After deployment, set API URL
   vercel env add VITE_API_URL production
   # Enter: https://your-backend-url.com
   ```

4. **Redeploy:**
   ```bash
   vercel --prod
   ```

### **âœ… Frontend Done!**

Your frontend will be live at: `https://meldra.vercel.app` (or similar)

---

## ðŸŽ¯ Step 2: Deploy Backend

### **Option A: Railway (Easiest - Recommended)**

#### **1. Sign Up:**
- Go to [railway.app](https://railway.app)
- Sign up with GitHub

#### **2. Create Project:**
- Click "New Project"
- Select "Deploy from GitHub repo"
- Choose your repository
- Select `backend` folder

#### **3. Add PostgreSQL:**
- Click "+ New"
- Select "Database" â†’ "PostgreSQL"
- Railway creates database automatically

#### **4. Set Environment Variables:**
In Railway project settings, add:
```
DATABASE_URL=<auto-generated-by-railway>
JWT_SECRET_KEY=<generate-strong-random-key>
OPENAI_API_KEY=<your-openai-key>
CORS_ORIGINS=https://meldra.vercel.app,https://meldra.ai
ACCESS_TOKEN_EXPIRE_MINUTES=30
ENVIRONMENT=production
```

#### **5. Deploy:**
- Railway auto-deploys on git push
- Or click "Deploy" button
- Get your backend URL: `https://your-app.railway.app`

---

### **Option B: Render (Free Tier Available)**

#### **1. Sign Up:**
- Go to [render.com](https://render.com)
- Sign up with GitHub

#### **2. Create Web Service:**
- Click "New" â†’ "Web Service"
- Connect your GitHub repo
- Settings:
  - **Name:** meldra-backend
  - **Root Directory:** backend
  - **Environment:** Python 3
  - **Build Command:** `pip install -r requirements.txt`
  - **Start Command:** `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

#### **3. Add PostgreSQL:**
- Click "New" â†’ "PostgreSQL"
- Create database
- Copy connection string

#### **4. Set Environment Variables:**
Same as Railway (see above)

#### **5. Deploy:**
- Render auto-deploys
- Get URL: `https://meldra-backend.onrender.com`

---

### **Option C: DigitalOcean App Platform**

#### **1. Sign Up:**
- Go to [digitalocean.com](https://digitalocean.com)

#### **2. Create App:**
- Connect GitHub repo
- Select `backend` folder
- Choose Python
- Add PostgreSQL database

#### **3. Configure:**
- Set environment variables
- Deploy

---

## ðŸŽ¯ Step 3: Update Frontend Environment

### **After Backend is Deployed:**

1. **Get your backend URL:**
   - Railway: `https://your-app.railway.app`
   - Render: `https://your-app.onrender.com`
   - DigitalOcean: `https://your-app.ondigitalocean.app`

2. **Update Vercel Environment Variable:**
   ```bash
   vercel env add VITE_API_URL production
   # Enter: https://your-backend-url.com
   ```

3. **Redeploy Frontend:**
   ```bash
   vercel --prod
   ```

---

## ðŸŽ¯ Step 4: Database Setup

### **If Using Neon (Your Current Database):**

Your database is already set up at:
```
postgresql://neondb_owner:npg_fDwMP0Rk2vAe@ep-small-dream-abw9afwj-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require
```

**Just use this in your backend environment variables!**

### **If Using Railway/Render Database:**

1. **Get connection string** from your provider
2. **Set as `DATABASE_URL`** in backend environment variables
3. **Run migrations:**
   ```bash
   # In backend
   python -c "from app.database import init_db; init_db()"
   ```

---

## ðŸ“‹ Complete Deployment Checklist

### **Frontend (Vercel):**
- [ ] Vercel account created
- [ ] Project deployed
- [ ] Environment variable `VITE_API_URL` set
- [ ] Custom domain configured (optional)
- [ ] App accessible at URL

### **Backend:**
- [ ] Backend service created (Railway/Render/etc.)
- [ ] PostgreSQL database added
- [ ] Environment variables set:
  - [ ] `DATABASE_URL`
  - [ ] `JWT_SECRET_KEY`
  - [ ] `OPENAI_API_KEY`
  - [ ] `CORS_ORIGINS`
- [ ] Backend deployed and accessible
- [ ] Health check works: `https://your-backend.com/health`

### **Database:**
- [ ] Database created
- [ ] Connection string configured
- [ ] Tables initialized
- [ ] Test connection works

### **Testing:**
- [ ] Frontend loads
- [ ] Backend API responds
- [ ] Login works
- [ ] All features functional
- [ ] Test on iPhone (PWA)

---

## ðŸš€ Quick Deployment Commands

### **Frontend (Vercel):**
```bash
# Deploy
vercel

# Set environment variable
vercel env add VITE_API_URL production

# Redeploy with new env
vercel --prod
```

### **Backend (Railway):**
```bash
# Install Railway CLI
npm i -g @railway/cli

# Login
railway login

# Link project
railway link

# Set environment variables
railway variables set DATABASE_URL="your-db-url"
railway variables set JWT_SECRET_KEY="your-secret"
railway variables set OPENAI_API_KEY="your-key"

# Deploy
railway up
```

---

## ðŸ”§ Environment Variables Reference

### **Frontend (.env or Vercel):**
```
VITE_API_URL=https://your-backend-url.com
```

### **Backend (Railway/Render/etc.):**
```
DATABASE_URL=postgresql://...
JWT_SECRET_KEY=your-super-secret-key
OPENAI_API_KEY=sk-...
CORS_ORIGINS=https://meldra.vercel.app,https://meldra.ai
ACCESS_TOKEN_EXPIRE_MINUTES=30
ENVIRONMENT=production
LOG_LEVEL=INFO
```

---

## ðŸ“± Test on iPhone After Deployment

1. **Open Safari on iPhone**
2. **Go to your Vercel URL**
3. **Tap Share â†’ "Add to Home Screen"**
4. **App works like native!** ðŸŽ‰

---

## ðŸŽ¯ Recommended Deployment Stack

### **Free Tier:**
- **Frontend:** Vercel (Free)
- **Backend:** Render (Free tier available)
- **Database:** Neon (Free tier) or Railway PostgreSQL

### **Production:**
- **Frontend:** Vercel Pro ($20/month)
- **Backend:** Railway ($5-20/month) or DigitalOcean ($12/month)
- **Database:** Railway PostgreSQL or DigitalOcean Managed DB

---

## âœ… Next Steps

1. **Complete Vercel login** (you're doing this!)
2. **Deploy frontend** (Vercel will do this automatically)
3. **Deploy backend** (choose Railway or Render)
4. **Set environment variables**
5. **Test everything**
6. **Test on iPhone**

---

## ðŸ†˜ Need Help?

- **Vercel Issues:** Check Vercel dashboard â†’ Deployments
- **Backend Issues:** Check service logs
- **Database Issues:** Test connection string

---

**You're on the right track! Complete the Vercel login and deployment will start automatically!** ðŸš€
